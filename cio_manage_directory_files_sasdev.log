1                                       The SAS System             11:20 Thursday, May 10, 2012

NOTE: Copyright (c) 2002-2008 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.2 (TS2M3) 
      Licensed to VALENCE HEALTH INC, Site 70106188.
NOTE: This session is executing on the X64_ESRV08  platform.



NOTE: SAS initialization used:
      real time           1.44 seconds
      cpu time            0.07 seconds
      
1          
2          options noxwait;
3          
4          libname cio "\\sas2\ci\programs\EDW";
NOTE: Libref CIO was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\sas2\ci\programs\EDW
5          
6          %macro cio_manage_directory_files;
7          
8          	data _null_;
9          	  set cio.cio_directory  end=eof;
10         	  where environment='SASDEV';
11         	    i+1;
12         	    ii=left(put(i,4.));
13         		call symput('dir'||ii,trim(dir));
14         		call symput('days'||ii,trim(days));
15         	    if eof then call symput('dir_total',ii);
16         	run;
17         	
18         	%put NOTE: dir_total = &dir_total. ;
19         
20         	%do j = 1 %to &dir_total. ;
21         		
22         		%let file_directory=&&dir&j. ;
23         		%let days=&&days&j. ;
24         		
25         		%put NOTE: file_directory = &file_directory. ;
26         		%put NOTE: days = &days. ;
27         
28         		data _null_;
29         		  call symput('sas_dir',"dir  &file_directory.\*.* ");
30         		run;
31         
32         		filename indata pipe "&sas_dir.";
33         		
34         		data file_directory;
35         		  length filename $50. deletefiles $100.;
36         		  format date mmddyy10.;
2                                       The SAS System             11:20 Thursday, May 10, 2012

37         		  infile indata truncover;
38         		  input File_Extract $100.;
39         			date2=scan(File_Extract,1,' ');
40         			date=input(date2,mmddyy10.);
41         			time=scan(File_Extract,2,' ');
42         			ampm=scan(File_Extract,3,' ');
43         			size=compress(scan(File_Extract,4,' '),',')*1;
44         			filename=scan(File_Extract,5,' ');
45         			ext=lowcase(scan(filename,2,'.'));
46         			deletefiles="&file_directory."||"\"||trim(left(filename));
47         			if index(filename,'.') > 0 and size > 0;
48         		run;
49         		
50         		data file_directory;
51         		set file_directory;
52         			if date < today() - &days. ; /**or  ext ne 'sas7bdat';**/
53         			drop date2 ;
54         		run;
55         
56         		proc sql noprint;
57         		select count(*) into: file_directory_cnt
58         		from file_directory;
59         		quit;
60         
61         		%put NOTE: file_directory_cnt = &file_directory_cnt. ;
62         
63         		%if &file_directory_cnt. ne 0 %then %do;
64         
65         			%put NOTE: Remove &file_directory_cnt files from &file_directory. ;
66         
67         			%let deletefiles_total=0;
68         
69         			data _null_;
70         			  set file_directory  end=eof;
71         			    i+1;
72         			    ii=left(put(i,4.));
73         				call symput('deletefiles'||ii,trim(deletefiles));
74         			    if eof then call symput('deletefiles_total',ii);
75         			run;
76         
77         			%do i = 1 %to &deletefiles_total. ;
78         			    x "del &&deletefiles&i";
79         			%end;
80         
81         		%end;
82         
83         	%end;
84         
85         %mend cio_manage_directory_files;
86         
3                                       The SAS System             11:20 Thursday, May 10, 2012

87         %cio_manage_directory_files;

NOTE: Numeric values have been converted to character values at the places given by: 
      (Line):(Column).
      87:184   
NOTE: There were 2 observations read from the data set CIO.CIO_DIRECTORY.
      WHERE environment='SASDEV';
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

NOTE: dir_total = 2
NOTE: file_directory = F:\SASTEMP\CIStaging\prod
NOTE: days = 21

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Character values have been converted to numeric values at the places given by: 
      (Line):(Column).
      87:175   
NOTE: The infile INDATA is:
      Unnamed Pipe Access Device,
      PROCESS=dir  F:\SASTEMP\CIStaging\prod\*.*,
      RECFM=V,LRECL=256

NOTE: Invalid argument to function INPUT at line 87 column 75.
NOTE: Invalid numeric data, 'F' , at line 87 column 175.
RULE:     ----+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+
1          Volume in drive F is saswork 29
filename=is deletefiles=F:\SASTEMP\CIStaging\prod\is date=.
File_Extract=Volume in drive F is saswork date2=Volume time=in ampm=drive size=. ext= 
_ERROR_=1 _N_=1
NOTE: Invalid argument to function INPUT at line 87 column 75.
NOTE: Invalid numeric data, 'is' , at line 87 column 175.
2          Volume Serial Number is 0E44-FD80 34
filename=0E44-FD80 deletefiles=F:\SASTEMP\CIStaging\prod\0E44-FD80 date=.
File_Extract=Volume Serial Number is 0E44-FD80 date2=Volume time=Serial ampm=Number size=.
ext=  _ERROR_=1 _N_=2
NOTE: Invalid argument to function INPUT at line 87 column 75.
4          Directory of F:\SASTEMP\CIStaging\prod 39
filename=  deletefiles=F:\SASTEMP\CIStaging\prod\ date=.
File_Extract=Directory of F:\SASTEMP\CIStaging\prod date2=Directory time=of
ampm=F:\SASTEMP\CIStaging\prod size=. ext=  _ERROR_=1 _N_=4
NOTE: Invalid numeric data, '<DIR>' , at line 87 column 175.
6         05/03/2012  12:19 PM    <DIR>          . 40
4                                       The SAS System             11:20 Thursday, May 10, 2012

filename=. deletefiles=F:\SASTEMP\CIStaging\prod\. date=05/03/2012
File_Extract=05/03/2012  12:19 PM    <DIR>          . date2=05/03/2012 time=12:19 ampm=PM
size=. ext=  _ERROR_=1 _N_=6
NOTE: Invalid numeric data, '<DIR>' , at line 87 column 175.
RULE:     ----+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+
7         05/03/2012  12:19 PM    <DIR>          .. 41
filename=.. deletefiles=F:\SASTEMP\CIStaging\prod\.. date=05/03/2012
File_Extract=05/03/2012  12:19 PM    <DIR>          .. date2=05/03/2012 time=12:19 ampm=PM
size=. ext=  _ERROR_=1 _N_=7
NOTE: Invalid argument to function INPUT at line 87 column 75.
NOTE: Invalid numeric data, 'bytes' , at line 87 column 175.
8                        0 File(s)              0 bytes 45
filename=  deletefiles=F:\SASTEMP\CIStaging\prod\ date=.
File_Extract=0 File(s)              0 bytes date2=0 time=File(s) ampm=0 size=. ext=  _ERROR_=1
_N_=8
NOTE: Invalid argument to function INPUT at line 87 column 75.
NOTE: Invalid numeric data, 'bytes' , at line 87 column 175.
9                        2 Dir(s)  1,796,504,911,872 bytes free 53
filename=free deletefiles=F:\SASTEMP\CIStaging\prod\free date=.
File_Extract=2 Dir(s)  1,796,504,911,872 bytes free date2=2 time=Dir(s) ampm=1,796,504,911,872
size=. ext=  _ERROR_=1 _N_=9
NOTE: 9 records were read from the infile INDATA.
      The minimum record length was 0.
      The maximum record length was 53.
NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      9 at 87:213   
NOTE: Mathematical operations could not be performed at the following places. The results of 
      the operations have been set to missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      5 at 87:75   
NOTE: The data set WORK.FILE_DIRECTORY has 0 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           1.02 seconds
      cpu time            0.01 seconds
      


NOTE: There were 0 observations read from the data set WORK.FILE_DIRECTORY.
NOTE: The data set WORK.FILE_DIRECTORY has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.32 seconds
      cpu time            0.00 seconds
      

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

5                                       The SAS System             11:20 Thursday, May 10, 2012

NOTE: file_directory_cnt =        0
NOTE: file_directory = F:\SASTEMP\CIStaging\test
NOTE: days = 21

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Character values have been converted to numeric values at the places given by: 
      (Line):(Column).
      87:175   
NOTE: The infile INDATA is:
      Unnamed Pipe Access Device,
      PROCESS=dir  F:\SASTEMP\CIStaging\test\*.*,
      RECFM=V,LRECL=256

NOTE: Invalid argument to function INPUT at line 87 column 75.
NOTE: Invalid numeric data, 'F' , at line 87 column 175.
RULE:     ----+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+
1          Volume in drive F is saswork 29
filename=is deletefiles=F:\SASTEMP\CIStaging\test\is date=.
File_Extract=Volume in drive F is saswork date2=Volume time=in ampm=drive size=. ext= 
_ERROR_=1 _N_=1
NOTE: Invalid argument to function INPUT at line 87 column 75.
NOTE: Invalid numeric data, 'is' , at line 87 column 175.
2          Volume Serial Number is 0E44-FD80 34
filename=0E44-FD80 deletefiles=F:\SASTEMP\CIStaging\test\0E44-FD80 date=.
File_Extract=Volume Serial Number is 0E44-FD80 date2=Volume time=Serial ampm=Number size=.
ext=  _ERROR_=1 _N_=2
NOTE: Invalid argument to function INPUT at line 87 column 75.
4          Directory of F:\SASTEMP\CIStaging\test 39
filename=  deletefiles=F:\SASTEMP\CIStaging\test\ date=.
File_Extract=Directory of F:\SASTEMP\CIStaging\test date2=Directory time=of
ampm=F:\SASTEMP\CIStaging\test size=. ext=  _ERROR_=1 _N_=4
NOTE: Invalid numeric data, '<DIR>' , at line 87 column 175.
6         05/10/2012  01:20 AM    <DIR>          . 40
filename=. deletefiles=F:\SASTEMP\CIStaging\test\. date=05/10/2012
File_Extract=05/10/2012  01:20 AM    <DIR>          . date2=05/10/2012 time=01:20 ampm=AM
size=. ext=  _ERROR_=1 _N_=6
NOTE: Invalid numeric data, '<DIR>' , at line 87 column 175.
7         05/10/2012  01:20 AM    <DIR>          .. 41
filename=.. deletefiles=F:\SASTEMP\CIStaging\test\.. date=05/10/2012
File_Extract=05/10/2012  01:20 AM    <DIR>          .. date2=05/10/2012 time=01:20 ampm=AM
size=. ext=  _ERROR_=1 _N_=7
NOTE: Invalid argument to function INPUT at line 87 column 75.
NOTE: Invalid numeric data, 'bytes' , at line 87 column 175.
367                    359 File(s) 32,965,445,994 bytes 45
filename=  deletefiles=F:\SASTEMP\CIStaging\test\ date=.
6                                       The SAS System             11:20 Thursday, May 10, 2012

File_Extract=359 File(s) 32,965,445,994 bytes date2=359 time=File(s) ampm=32,965,445,994 size=.
ext=  _ERROR_=1 _N_=367
NOTE: Invalid argument to function INPUT at line 87 column 75.
NOTE: Invalid numeric data, 'bytes' , at line 87 column 175.
RULE:     ----+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+
368                      2 Dir(s)  1,793,328,091,136 bytes free 53
filename=free deletefiles=F:\SASTEMP\CIStaging\test\free date=.
File_Extract=2 Dir(s)  1,793,328,091,136 bytes free date2=2 time=Dir(s) ampm=1,793,328,091,136
size=. ext=  _ERROR_=1 _N_=368
NOTE: 368 records were read from the infile INDATA.
      The minimum record length was 0.
      The maximum record length was 80.
NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      9 at 87:213   
NOTE: Mathematical operations could not be performed at the following places. The results of 
      the operations have been set to missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      5 at 87:75   
NOTE: The data set WORK.FILE_DIRECTORY has 353 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           8.12 seconds
      cpu time            0.00 seconds
      


NOTE: There were 353 observations read from the data set WORK.FILE_DIRECTORY.
NOTE: The data set WORK.FILE_DIRECTORY has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: file_directory_cnt =        0

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           12.09 seconds
      cpu time            0.10 seconds
      
